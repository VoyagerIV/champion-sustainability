{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.useCommonVariables = useCommonVariables;\nvar _react = _interopRequireDefault(require(\"react\"));\nvar _reactNativeReanimated = require(\"react-native-reanimated\");\nvar _computeNewIndexWhenDataChanges = require(\"./computeNewIndexWhenDataChanges\");\nvar _handlerOffsetDirection = require(\"../utils/handlerOffsetDirection\");\nfunction useCommonVariables(props) {\n  var vertical = props.vertical,\n    height = props.height,\n    width = props.width,\n    dataLength = props.dataLength,\n    defaultIndex = props.defaultIndex,\n    defaultScrollOffsetValue = props.defaultScrollOffsetValue,\n    loop = props.loop;\n  var size = vertical ? height : width;\n  var validLength = dataLength - 1;\n  var defaultHandlerOffsetValue = -Math.abs(defaultIndex * size);\n  var _handlerOffset = (0, _reactNativeReanimated.useSharedValue)(defaultHandlerOffsetValue);\n  var handlerOffset = defaultScrollOffsetValue != null ? defaultScrollOffsetValue : _handlerOffset;\n  var prevDataLength = (0, _reactNativeReanimated.useSharedValue)(dataLength);\n  _react.default.useEffect(function () {\n    handlerOffset.value = defaultHandlerOffsetValue;\n  }, [vertical, handlerOffset, defaultHandlerOffsetValue]);\n  (0, _reactNativeReanimated.useAnimatedReaction)(function () {\n    var _f = function _f() {\n      var previousLength = prevDataLength.value;\n      var currentLength = dataLength;\n      var isLengthChanged = previousLength !== currentLength;\n      var shouldComputed = isLengthChanged && loop;\n      if (shouldComputed) prevDataLength.value = dataLength;\n      return {\n        shouldComputed: shouldComputed,\n        previousLength: previousLength,\n        currentLength: currentLength\n      };\n    };\n    _f._closure = {\n      prevDataLength: prevDataLength,\n      dataLength: dataLength,\n      loop: loop\n    };\n    _f.asString = \"function _f(){const{prevDataLength,dataLength,loop}=jsThis._closure;{const previousLength=prevDataLength.value;const currentLength=dataLength;const isLengthChanged=previousLength!==currentLength;const shouldComputed=isLengthChanged&&loop;if(shouldComputed)prevDataLength.value=dataLength;return{shouldComputed:shouldComputed,previousLength:previousLength,currentLength:currentLength};}}\";\n    _f.__workletHash = 13698961874962;\n    _f.__location = \"/Users/zhaodonghao/code/github/react-native-reanimated-carousel/src/hooks/useCommonVariables.ts (39:22)\";\n    return _f;\n  }(), function () {\n    var _f = function _f(_ref) {\n      var shouldComputed = _ref.shouldComputed,\n        previousLength = _ref.previousLength,\n        currentLength = _ref.currentLength;\n      if (shouldComputed) {\n        var direction = (0, _handlerOffsetDirection.handlerOffsetDirection)(handlerOffset);\n        handlerOffset.value = (0, _computeNewIndexWhenDataChanges.computeNewIndexWhenDataChanges)({\n          direction: direction,\n          previousLength: previousLength,\n          currentLength: currentLength,\n          size: size,\n          handlerOffset: handlerOffset.value\n        });\n      }\n    };\n    _f._closure = {\n      handlerOffsetDirection: _handlerOffsetDirection.handlerOffsetDirection,\n      handlerOffset: handlerOffset,\n      computeNewIndexWhenDataChanges: _computeNewIndexWhenDataChanges.computeNewIndexWhenDataChanges,\n      size: size\n    };\n    _f.asString = \"function _f({shouldComputed:shouldComputed,previousLength:previousLength,currentLength:currentLength}){const{handlerOffsetDirection,handlerOffset,computeNewIndexWhenDataChanges,size}=jsThis._closure;{if(shouldComputed){const direction=handlerOffsetDirection(handlerOffset);handlerOffset.value=computeNewIndexWhenDataChanges({direction:direction,previousLength:previousLength,currentLength:currentLength,size:size,handlerOffset:handlerOffset.value});}}}\";\n    _f.__workletHash = 7425703877323;\n    _f.__location = \"/Users/zhaodonghao/code/github/react-native-reanimated-carousel/src/hooks/useCommonVariables.ts (53:5)\";\n    return _f;\n  }(), [dataLength, loop]);\n  return {\n    size: size,\n    validLength: validLength,\n    handlerOffset: handlerOffset\n  };\n}","map":{"version":3,"mappings":";;;;;AAAA;AAEA;AAEA;AAGA;AAQO,SAASA,kBAAT,CACLC,KADK,EAEa;EAClB,IACEC,QADF,GAQID,KARJ,CACEC,QADF;IAEEC,MAFF,GAQIF,KARJ,CAEEE,MAFF;IAGEC,KAHF,GAQIH,KARJ,CAGEG,KAHF;IAIEC,UAJF,GAQIJ,KARJ,CAIEI,UAJF;IAKEC,YALF,GAQIL,KARJ,CAKEK,YALF;IAMEC,wBANF,GAQIN,KARJ,CAMEM,wBANF;IAOEC,IAPF,GAQIP,KARJ,CAOEO,IAPF;EASA,IAAMC,IAAI,GAAGP,QAAQ,GAAGC,MAAH,GAAYC,KAAjC;EACA,IAAMM,WAAW,GAAGL,UAAU,GAAG,CAAjC;EACA,IAAMM,yBAAyB,GAAG,CAACC,IAAI,CAACC,GAAL,CAASP,YAAY,GAAGG,IAAxB,CAAnC;EACA,IAAMK,cAAc,GAAG,2CAAuBH,yBAAvB,CAAvB;EACA,IAAMI,aAAa,GAAGR,wBAAH,WAAGA,wBAAH,GAA+BO,cAAlD;EACA,IAAME,cAAc,GAAG,2CAAeX,UAAf,CAAvB;EAEAY,eAAMC,SAAN,CAAgB,YAAM;IACpBH,aAAa,CAACI,KAAd,GAAsBR,yBAAtB;EACD,CAFD,EAEG,CAACT,QAAD,EAAWa,aAAX,EAA0BJ,yBAA1B,CAFH;EAIA;IAAA,uBAA0B;MACxB,IAAMS,cAAc,GAAGJ,cAAc,CAACG,KAAtC;MACA,IAAME,aAAa,GAAGhB,UAAtB;MACA,IAAMiB,eAAe,GAAGF,cAAc,KAAKC,aAA3C;MACA,IAAME,cAAc,GAAGD,eAAe,IAAId,IAA1C;MAEA,IAAIe,cAAJ,EACEP,cAAc,CAACG,KAAf,GAAuBd,UAAvB;MAEF,OAAO;QACLkB,cAAc,EAAdA,cADK;QAELH,cAAc,EAAdA,cAFK;QAGLC,aAAa,EAAbA;MAHK,CAAP;IAKD,CAdD;IAAAG;MAAAR,gBAhCoBA,cAgCpB;MAAAX,YAhC2CA,UAgC3C;MAAAG,MAjC0CA;IAiC1C;IAAAgB;IAAAA;IAAAA;IAAA;EAAA;IAAA,2BAc0D;MAAA,IAApDD,cAAoD,QAApDA,cAAoD;QAApCH,cAAoC,QAApCA,cAAoC;QAApBC,aAAoB,QAApBA,aAAoB;MACxD,IAAIE,cAAJ,EAAoB;QAElB,IAAME,SAAS,GAAG,oDAAuBV,aAAvB,CAAlB;QAEAA,aAAa,CAACI,KAAd,GAAsB,oEAA+B;UACnDM,SAAS,EAATA,SADmD;UAEnDL,cAAc,EAAdA,cAFmD;UAGnDC,aAAa,EAAbA,aAHmD;UAInDZ,IAAI,EAAJA,IAJmD;UAKnDM,aAAa,EAAEA,aAAa,CAACI;QALsB,CAA/B,CAAtB;MAOD;IACF,CA3BD;IAAAK;MAAAE,wBA9BoBA,8CA8BpB;MAAAX,eAxBmBA,aAwBnB;MAAAY,gCA7BwBA,8DA6BxB;MAAAlB,MAzBIA;IAyBJ;IAAAe;IAAAA;IAAAA;IAAA;EAAA,KA2BG,CAACnB,UAAD,EAAaG,IAAb,CA3BH;EA6BA,OAAO;IACLC,IAAI,EAAJA,IADK;IAELC,WAAW,EAAXA,WAFK;IAGLK,aAAa,EAAbA;EAHK,CAAP;AAKD","names":["useCommonVariables","props","vertical","height","width","dataLength","defaultIndex","defaultScrollOffsetValue","loop","size","validLength","defaultHandlerOffsetValue","Math","abs","_handlerOffset","handlerOffset","prevDataLength","React","useEffect","value","previousLength","currentLength","isLengthChanged","shouldComputed","_f","direction","handlerOffsetDirection","computeNewIndexWhenDataChanges"],"sources":["useCommonVariables.ts"],"sourcesContent":["import React from \"react\";\nimport type Animated from \"react-native-reanimated\";\nimport { useSharedValue, useAnimatedReaction } from \"react-native-reanimated\";\n\nimport { computeNewIndexWhenDataChanges } from \"./computeNewIndexWhenDataChanges\";\nimport type { TInitializeCarouselProps } from \"./useInitProps\";\n\nimport { handlerOffsetDirection } from \"../utils/handlerOffsetDirection\";\n\ninterface ICommonVariables {\n  size: number\n  validLength: number\n  handlerOffset: Animated.SharedValue<number>\n}\n\nexport function useCommonVariables(\n  props: TInitializeCarouselProps<any>,\n): ICommonVariables {\n  const {\n    vertical,\n    height,\n    width,\n    dataLength,\n    defaultIndex,\n    defaultScrollOffsetValue,\n    loop,\n  } = props;\n  const size = vertical ? height : width;\n  const validLength = dataLength - 1;\n  const defaultHandlerOffsetValue = -Math.abs(defaultIndex * size);\n  const _handlerOffset = useSharedValue<number>(defaultHandlerOffsetValue);\n  const handlerOffset = defaultScrollOffsetValue ?? _handlerOffset;\n  const prevDataLength = useSharedValue(dataLength);\n\n  React.useEffect(() => {\n    handlerOffset.value = defaultHandlerOffsetValue;\n  }, [vertical, handlerOffset, defaultHandlerOffsetValue]);\n\n  useAnimatedReaction(() => {\n    const previousLength = prevDataLength.value;\n    const currentLength = dataLength;\n    const isLengthChanged = previousLength !== currentLength;\n    const shouldComputed = isLengthChanged && loop;\n\n    if (shouldComputed)\n      prevDataLength.value = dataLength;\n\n    return {\n      shouldComputed,\n      previousLength,\n      currentLength,\n    };\n  }, ({ shouldComputed, previousLength, currentLength }) => {\n    if (shouldComputed) {\n      // direction -> 1 | -1\n      const direction = handlerOffsetDirection(handlerOffset);\n\n      handlerOffset.value = computeNewIndexWhenDataChanges({\n        direction,\n        previousLength,\n        currentLength,\n        size,\n        handlerOffset: handlerOffset.value,\n      });\n    }\n  }, [dataLength, loop]);\n\n  return {\n    size,\n    validLength,\n    handlerOffset,\n  };\n}\n"]},"metadata":{},"sourceType":"script"}